using Newtonsoft.Json;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace RAG.DataStax
{
    internal class Writer
    {
        public async Task CreateCollectionAsync(string  collectionName)
        {
            var client = new HttpClient();
            var request = new HttpRequestMessage(HttpMethod.Post, "https://953ccde9-fa5a-4634-a3a9-31d41d3bfb33-us-east1.apps.astra.datastax.com/api/json/v1/default_keyspace");
            request.Headers.Add("Token", "AstraCS:jBqdQovblyPQlWIgBZtsGEws:aa14ebbbcd7f99d3f419f9ae56439cacd776bbc0bf20892e654a42a72a187879");
            var content = new StringContent("{\n  \"createCollection\": {\n    \"name\": \"" + collectionName + "\",\n    \"options\" : {\n      \"vector\" : {\n        \"dimension\" : 1536,\n        \"metric\" : \"cosine\"\n      }\n    }\n  }\n}", null, "application/json");
            request.Content = content;
            var response = await client.SendAsync(request);
            response.EnsureSuccessStatusCode();
            Console.WriteLine(await response.Content.ReadAsStringAsync());

        }
        public async Task WriteAsync(string collectionName, string id, string company, List<double> vector)
        {
            Customer customer = new Customer(id, company, vector);

            string customerJson = JsonConvert.SerializeObject(customer);


            var client = new HttpClient();
            var request = new HttpRequestMessage(HttpMethod.Post, "https://953ccde9-fa5a-4634-a3a9-31d41d3bfb33-us-east1.apps.astra.datastax.com/api/json/v1/default_keyspace/" + collectionName);
            request.Headers.Add("Token", "AstraCS:jBqdQovblyPQlWIgBZtsGEws:aa14ebbbcd7f99d3f419f9ae56439cacd776bbc0bf20892e654a42a72a187879");
            //var content = new StringContent("{\n  \"insertOne\": {\n    \"document\": {\n      \"_id\": \"2\",\n      \"company\": \"Scooby Snack Solutions\",\n      \"$vector\": [\n                0.00633768,\n                -0.02958455,\n                0.0025073036,\n                -0.0028976917,\n                -0.034968313,\n                0.0047663273,\n                0.021417437,\n                -0.032485507,\n                -0.018568749,\n                0.0003185174,\n                0.028356217,\n                0.005654909,\n                0.00039365486,\n                0.0010845927,\n                -0.0043253032,\n                0.001117261,\n                0.034837637,\n                -0.004998273,\n                0.00091308326,\n                -0.008180181,\n                -0.0020613794,\n                0.008702876,\n                -0.01805912,\n                0.0026020422,\n                0.024723485,\n                -0.01025136,\n                -0.0036817344,\n                -0.018516479,\n                0.0023521285,\n                0.01581153,\n                0.012544686,\n                0.0040835566,\n                -0.026513716,\n                -0.0008138528,\n                -0.012988976,\n                -0.01396903,\n                -0.0023880638,\n                -0.014478658,\n                0.009179835,\n                -0.01720974,\n                -0.011995856,\n                0.02529845,\n                -0.001677525,\n                0.005841119,\n                -0.01855568,\n                -0.010963532,\n                -0.012106928,\n                -0.01164957,\n                0.0022018536,\n                -0.00078975986,\n                0.0067362348,\n                0.007892698,\n                -0.02225375,\n                0.0008583636,\n                0.022123076,\n                0.0055797715,\n                -0.02045045,\n                -0.00042019796,\n                0.032720722,\n                -0.016386496,\n                0.012257203,\n                -0.0015525682,\n                -0.015380307,\n                -0.008428461,\n                0.007004116,\n                -0.027781252,\n                0.01117261,\n                -0.0137076825,\n                -0.023704229,\n                0.008944622,\n                0.034942176,\n                0.002667379,\n                0.00040080107,\n                -0.012316006,\n                0.022371355,\n                -0.0035412603,\n                -0.02239749,\n                0.019352792,\n                -0.0019127378,\n                -0.014700803,\n                0.01092433,\n                -0.037607923,\n                -0.015798463,\n                0.018124457,\n                0.008833549,\n                -0.008820482,\n                -0.03546487,\n                0.01811139,\n                -0.017876176,\n                0.0146224,\n                0.01232254,\n                0.019326657,\n                -0.020241372,\n                -0.009186368,\n                -0.0329298,\n                0.019339724,\n                -0.035098985,\n                0.028434621,\n                -0.02290712,\n                -0.014138906,\n                -0.013407133,\n                0.031910542,\n                -0.012766831,\n                -0.016687045,\n                0.0044167745,\n                -0.003208042,\n                -0.00043204028,\n                0.000017584814,\n                0.016046744,\n                0.00029809962,\n                -0.0028650232,\n                0.034889907,\n                -0.0012993877,\n                -0.024814956,\n                0.012172265,\n                0.010244827,\n                0.01786311,\n                -0.012440147,\n                -0.0134724695,\n                -0.0088531505,\n                0.013433267,\n                -0.0030594005,\n                0.021953199,\n                -0.013590076,\n                0.022214547,\n                -0.007703221,\n                -0.01085246,\n                -0.013178454,\n                0.025612066,\n                -0.029924301,\n                0.02175719,\n                0.003652333,\n                0.021339033,\n                -0.0033942522,\n                -0.030107245,\n                0.009833204,\n                -0.021339033,\n                0.020058429,\n                0.004201163,\n                -0.016072879,\n                0.016386496,\n                0.03198895,\n                -0.022959389,\n                0.0010478406,\n                -0.006007728,\n                0.035203524,\n                0.0068865097,\n                0.00033321822,\n                -0.0014153607,\n                -0.009944277,\n                0.012851769,\n                -0.010702185,\n                -0.023390612,\n                0.007912299,\n                0.0396203,\n                0.015772328,\n                -0.004302435,\n                0.015628587,\n                -0.034654696,\n                0.013550874,\n                -0.0004806346,\n                0.005044009,\n                -0.012851769,\n                -0.011290217,\n                -0.011963187,\n                0.013929828,\n                0.024788821,\n                -0.017850041,\n                -0.0050113406,\n                0.020071497,\n                0.0028323547,\n                0.04735619,\n                -0.017196674,\n                0.007304666,\n                -0.019117579,\n                -0.02230602,\n                -0.0041750283,\n                0.004874133,\n                -0.028774373,\n                -0.019862419,\n                0.031021962,\n                0.015510981,\n                0.0027539504,\n                0.026265435,\n                0.016334226,\n                -0.024684282,\n                0.018398872,\n                0.0014104604,\n                0.02942774,\n                -0.022319086,\n                0.011081139,\n                0.026356908,\n                0.0011629969,\n                -0.010760988,\n                -0.6489784,\n                -0.022684973,\n                0.00572678,\n                -0.045918778,\n                -0.014256513,\n                0.02305086,\n                0.0067885043,\n                -0.01267536,\n                -0.0044559767,\n                0.02090781,\n                0.004286101,\n                0.0034563222,\n                -0.004557249,\n                -0.0036457994,\n                -0.027728982,\n                -0.015118959,\n                0.013577009,\n                -0.013629278,\n                0.014740005,\n                0.0025252714,\n                -0.02374343,\n                0.018725557,\n                -0.009232105,\n                -0.01896077,\n                0.023390612,\n                0.012414012,\n                -0.0005137114,\n                -0.025625134,\n                -0.0031051363,\n                0.018202862,\n                -0.011094206,\n                0.04581424,\n                0.0033011471,\n                0.02664439,\n                0.05344559,\n                0.02105155,\n                -0.012048125,\n                0.026369974,\n                0.00025277215,\n                0.04565743,\n                -0.015654722,\n                -0.031806003,\n                0.009885473,\n                0.018516479,\n                -0.0317276,\n                0.003420387,\n                0.030760614,\n                0.018398872,\n                -0.01611208,\n                0.0134724695,\n                0.012152664,\n                -0.020568058,\n                -0.01926132,\n                -0.0018098323,\n                0.0195096,\n                0.015746193,\n                0.018830096,\n                -0.030943558,\n                0.005828052,\n                0.004985206,\n                0.0023635626,\n                0.01329606,\n                -0.0078012263,\n                -0.009519587,\n                -0.026082492,\n                0.040979307,\n                0.0053706937,\n                -0.0047467262,\n                0.02599102,\n                -0.006860375,\n                0.016556371,\n                0.039254412,\n                -0.0070237173,\n                0.00020703631,\n                0.00950652,\n                0.02689267,\n                0.03217189,\n                -0.008101776,\n                0.01140129,\n                0.004132559,\n                0.0004061097,\n                0.0029368938,\n                -0.027075613,\n                0.0041064243,\n                0.0077293557,\n                0.010395101,\n                -0.004792462,\n                0.023939442,\n                0.026866535,\n                -0.024632012,\n                0.024161587,\n                -0.0026347106,\n                0.0050766775,\n                -0.019470397,\n                -0.0017542959,\n                0.01049964,\n                -0.03577849,\n                0.019574936,\n                0.020528855,\n                -0.046624415,\n                -0.024488272,\n                0.021953199,\n                0.018686354,\n                -0.015275768,\n                -0.0034661228,\n                0.026709726,\n                0.017039865,\n                0.014374119,\n                -0.003609864,\n                -0.029636819,\n                0.019823216,\n                -0.017967649,\n                -0.00713479,\n                -0.024331464,\n                -0.016883057,\n                -0.027415365,\n                0.023887172,\n                -0.017993784,\n                0.011427425,\n                -0.031806003,\n                -0.0084153935,\n                -0.007722822,\n                0.023024725,\n                -0.008206315,\n                0.009382379,\n                0.000731365,\n                0.014478658,\n                -0.0036457994,\n                -0.032955933,\n                -0.017902311,\n                -0.002407665,\n                -0.029349338,\n                -0.0024403334,\n                -0.003691535,\n                -0.017889244,\n                0.02175719,\n                0.014047435,\n                -0.013642346,\n                -0.0036065972,\n                -0.014936016,\n                -0.011714907,\n                0.0084807305,\n                -0.0071935933,\n                -0.003982284,\n                -0.0004291818,\n                -0.013537806,\n                0.0008526466,\n                -0.004854532,\n                0.0070367847,\n                -0.0072523966,\n                0.0032652118,\n                -0.0043743057,\n                0.010094551,\n                0.019627206,\n                0.0064879544,\n                -0.0054327636,\n                -0.018581815,\n                -0.028460756,\n                0.027519904,\n                -0.019496532,\n                0.029323203,\n                -0.005194284,\n                -0.024383733,\n                -0.011394756,\n                -0.013073915,\n                -0.016033676,\n                0.017693233,\n                0.011793311,\n                0.01926132,\n                -0.026631322,\n                -0.018438075,\n                -0.028434621,\n                -0.0038450768,\n                0.0125969555,\n                0.0017118269,\n                0.010676051,\n                -0.023181533,\n                0.0011540131,\n                0.0018849696,\n                -0.011055004,\n                -0.014818409,\n                -0.01110074,\n                -0.0134724695,\n                0.012250669,\n                0.011865182,\n                -0.020071497,\n                0.051616155,\n                0.016138215,\n                -0.0011580966,\n                -0.0037732061,\n                0.0019699077,\n                0.013681548,\n                -0.0056222407,\n                0.009545722,\n                -0.020463519,\n                -0.018986905,\n                0.016687045,\n                -0.011643036,\n                0.0057986504,\n                0.028408486,\n                0.024723485,\n                -0.008363124,\n                0.0045213136,\n                -0.028016465,\n                0.01731428,\n                -0.036431856,\n                0.016425697,\n                -0.02190093,\n                0.009284374,\n                0.0022312552,\n                0.022005469,\n                0.007180526,\n                0.010702185,\n                -0.018725557,\n                -0.0013573741,\n                0.03896693,\n                -0.0058737877,\n                0.007768558,\n                -0.024880294,\n                0.01906531,\n                0.010146821,\n                -0.0091210315,\n                0.012688427,\n                -0.014740005,\n                -0.019287454,\n                0.0286437,\n                -0.010186023,\n                0.015667789,\n                -0.005135481,\n                -0.013093515,\n                0.0026869802,\n                0.040378205,\n                0.019418128,\n                0.03617051,\n                0.0070171836,\n                -0.012570821,\n                0.011852114,\n                -0.004998273,\n                0.04275647,\n                0.0048872004,\n                -0.01122488,\n                0.03562168,\n                0.017301213,\n                0.020751001,\n                0.002497503,\n                0.013851424,\n                0.011793311,\n                -0.005831319,\n                -0.0007154391,\n                0.00031810906,\n                -0.019470397,\n                -0.016909191,\n                -0.014740005,\n                0.002450134,\n                0.01110074,\n                0.01990162,\n                -0.0032717455,\n                0.0042109634,\n                0.028277813,\n                0.008363124,\n                -0.0064716204,\n                -0.00031974248,\n                -0.0062821433,\n                0.004077023,\n                0.032250296,\n                0.003459589,\n                0.0041488935,\n                -0.0122245345,\n                0.02425306,\n                -0.026108626,\n                -0.008265118,\n                -0.017732436,\n                -0.012433613,\n                -0.010917797,\n                0.004469044,\n                -0.0055601704,\n                -0.028147139,\n                0.035700083,\n                -0.013276459,\n                0.004308969,\n                -0.029636819,\n                -0.014962151,\n                0.005145281,\n                -0.00049492705,\n                0.013139252,\n                0.011479694,\n                -0.0031361715,\n                0.0059587257,\n                -0.008546067,\n                0.018699422,\n                0.016072879,\n                0.023364477,\n                -0.009415048,\n                0.038862392,\n                -0.0081083095,\n                0.0037634056,\n                0.0022900584,\n                0.0008534633,\n                0.002399498,\n                0.011159543,\n                0.037895404,\n                0.026160896,\n                -0.017471088,\n                -0.006945313,\n                0.0089511555,\n                -0.010153355,\n                -0.015105892,\n                0.0036817344,\n                -0.024958698,\n                -0.025572864,\n                -0.005556904,\n                -0.012048125,\n                -0.02538992,\n                -0.008441528,\n                0.0024321664,\n                -0.00070768036,\n                -0.008291253,\n                -0.016072879,\n                0.028016465,\n                0.018228997,\n                -0.0029401607,\n                -0.017235875,\n                -0.01910451,\n                0.022554299,\n                0.10830245,\n                0.017248943,\n                -0.028800508,\n                0.0073896036,\n                0.0065663587,\n                0.023246871,\n                -0.027127882,\n                -0.017497223,\n                0.015249633,\n                -0.017431887,\n                -0.0077816253,\n                0.0092582395,\n                0.013511672,\n                -0.002226355,\n                0.005004807,\n                0.003208042,\n                -0.015484846,\n                -0.0002403173,\n                0.0042305645,\n                -0.008735544,\n                0.010819791,\n                -0.0082455175,\n                -0.002427266,\n                0.009545722,\n                0.023116197,\n                -0.009212503,\n                0.016817719,\n                0.04989126,\n                -0.009722131,\n                -0.038810123,\n                -0.005511168,\n                -0.00095800235,\n                -0.010891662,\n                -0.02184866,\n                -0.01866022,\n                0.0049819387,\n                0.015197364,\n                0.021548111,\n                0.008742078,\n                -0.0039398153,\n                0.02942774,\n                0.01048004,\n                0.0027000476,\n                0.024370665,\n                0.023076994,\n                -0.0082455175,\n                -0.0046911896,\n                0.021378236,\n                0.026539851,\n                -0.0010764255,\n                0.026213165,\n                0.0074353395,\n                0.012387877,\n                0.01049964,\n                0.011982788,\n                -0.02150891,\n                -0.011793311,\n                -0.022384424,\n                -0.0052661547,\n                -0.039280545,\n                -0.021025416,\n                -0.028016465,\n                -0.013446335,\n                -0.0132699255,\n                -0.00250077,\n                -0.042678066,\n                -0.03117877,\n                -0.015288835,\n                -0.009748266,\n                0.00493947,\n                0.005831319,\n                -0.023612756,\n                -0.020372046,\n                0.015641656,\n                0.017732436,\n                0.010323231,\n                0.0032178424,\n                -0.0021822527,\n                0.0065369573,\n                0.0012528352,\n                0.0036000635,\n                -0.010323231,\n                -0.030551536,\n                -0.018581815,\n                0.021129955,\n                0.0047009904,\n                0.016869988,\n                -0.040038455,\n                -0.010793656,\n                -0.0035085918,\n                0.026173964,\n                0.034837637,\n                0.0061155343,\n                -0.000701555,\n                -0.0021169158,\n                0.0007040051,\n                0.014962151,\n                -0.00823245,\n                0.026160896,\n                0.0070367847,\n                0.025272315,\n                -0.010950465,\n                -0.022645772,\n                -0.0027294492,\n                -0.002497503,\n                0.0019372392,\n                -0.019940823,\n                0.0034530554,\n                0.016072879,\n                0.0017853309,\n                0.022292951,\n                -0.00087061425,\n                -0.002156118,\n                0.0044592437,\n                -0.012316006,\n                0.004305702,\n                -0.020045362,\n                -0.00054311304,\n                -0.014125839,\n                -0.0048512653,\n                0.011734508,\n                -0.016151283,\n                0.023665026,\n                0.010630314,\n                -0.030865153,\n                -0.0018947702,\n                0.008336989,\n                -0.031048097,\n                -0.026265435,\n                -0.032851394,\n                -0.017183606,\n                0.025024034,\n                -0.016647844,\n                -0.023194602,\n                -0.020228306,\n                -0.0025873415,\n                -0.019274388,\n                -0.0141127715,\n                -0.007618283,\n                -0.027755117,\n                0.00017926813,\n                -0.0043547046,\n                0.004351438,\n                -0.012727628,\n                -0.010956999,\n                -0.03802608,\n                -0.0030283656,\n                -0.0060697985,\n                0.016595574,\n                0.025010968,\n                -0.025729673,\n                -0.005070144,\n                -0.016033676,\n                -0.018817028,\n                0.00634748,\n                -0.028225543,\n                -0.010839392,\n                0.034445617,\n                0.028748238,\n                0.03303434,\n                0.034132,\n                0.008376191,\n                0.0010233392,\n                0.0016791584,\n                0.00055658875,\n                -0.0075660134,\n                -0.017889244,\n                -0.02554673,\n                -0.021247562,\n                0.0074549406,\n                -0.00047001734,\n                0.016739314,\n                -0.00006176379,\n                0.0010347732,\n                -0.021913998,\n                0.014883746,\n                -0.0048872004,\n                -0.037634056,\n                0.014596265,\n                -0.0457881,\n                0.004838198,\n                -0.0092909075,\n                -0.0040541547,\n                0.02953228,\n                -0.023730364,\n                -0.0041456264,\n                0.0066512967,\n                0.038601045,\n                -0.012178799,\n                -0.0024158321,\n                0.03951576,\n                0.01055191,\n                -0.0069518466,\n                0.009990012,\n                -0.01366848,\n                0.0077750916,\n                -0.017379617,\n                -0.019548802,\n                -0.034210403,\n                -0.011139942,\n                0.0064912215,\n                0.0063213455,\n                -0.0082455175,\n                -0.0023978644,\n                -0.0004814513,\n                -0.0001979504,\n                -0.0046977233,\n                -0.017301213,\n                0.024436003,\n                -0.012178799,\n                -0.045369945,\n                -0.011682238,\n                -0.03018565,\n                -0.02908799,\n                -0.0042305645,\n                0.0040606884,\n                -0.02329914,\n                0.0020450451,\n                -0.021992402,\n                -0.0009089997,\n                -0.004158694,\n                -0.02948001,\n                0.015118959,\n                0.0029189263,\n                -0.0035967967,\n                0.044089343,\n                0.007324267,\n                -0.011146476,\n                0.030342458,\n                0.0045017125,\n                -0.004955804,\n                -0.007703221,\n                0.029715223,\n                -0.028460756,\n                -0.020045362,\n                -0.0025938752,\n                0.006821173,\n                -0.018621018,\n                -0.04186789,\n                0.019770946,\n                0.009780935,\n                -0.00059619924,\n                -0.017052932,\n                -0.019052241,\n                0.0042893677,\n                0.008872751,\n                0.0013875925,\n                0.007677086,\n                -0.020136833,\n                -0.00063580973,\n                -0.023756498,\n                0.017444953,\n                0.0063834153,\n                0.019052241,\n                0.005886855,\n                0.010591112,\n                -0.0155632505,\n                0.013603143,\n                -0.031152636,\n                0.0020450451,\n                0.00052228686,\n                0.007611749,\n                -0.013563941,\n                0.013590076,\n                0.0031623063,\n                0.0049231355,\n                0.0053902944,\n                0.030551536,\n                -0.005106079,\n                0.024710417,\n                -0.01426958,\n                -0.020541923,\n                -0.011447025,\n                -0.008813948,\n                -0.0036033303,\n                0.0041064243,\n                -0.010525775,\n                -0.014857612,\n                -0.02678813,\n                -0.020711798,\n                0.021587312,\n                0.027650578,\n                -0.005592839,\n                -0.0019927756,\n                0.0027049477,\n                0.010088018,\n                -0.014099704,\n                -0.027519904,\n                0.007075987,\n                -0.006177604,\n                -0.0063246125,\n                -0.018189793,\n                0.027415365,\n                -0.02359969,\n                -0.0032864462,\n                -0.009669862,\n                -0.0032750124,\n                0.008500331,\n                -0.0042566992,\n                0.0096959965,\n                -0.022384424,\n                0.0023129263,\n                -0.035098985,\n                0.0038940795,\n                0.014635467,\n                -0.008709409,\n                0.020737933,\n                0.009617592,\n                -0.0061318683,\n                -0.008167113,\n                -0.02919253,\n                0.036144376,\n                -0.0062756096,\n                -0.012113462,\n                0.0025759074,\n                0.015471779,\n                0.023259938,\n                -0.017131336,\n                -0.016739314,\n                0.037712462,\n                -0.013590076,\n                -0.007618283,\n                -0.0040345537,\n                -0.0048643327,\n                0.0061057336,\n                0.010636848,\n                0.024658147,\n                -0.008029905,\n                -0.0043351036,\n                -0.017575627,\n                -0.022737242,\n                0.0053772274,\n                -0.0015582852,\n                0.0034497885,\n                -0.025559796,\n                -0.0084153935,\n                -0.006670898,\n                0.0049656047,\n                -0.010904729,\n                -0.00591299,\n                0.0027898857,\n                0.028225543,\n                -0.0010535576,\n                0.0013426734,\n                0.012505484,\n                -0.009539188,\n                -0.008846616,\n                -0.034158133,\n                -0.02549446,\n                0.0008318205,\n                0.0073112,\n                0.02299859,\n                0.024043981,\n                -0.004998273,\n                0.016830787,\n                0.008565668,\n                -0.024174655,\n                -0.014308782,\n                -0.025651269,\n                0.0005957909,\n                0.02025444,\n                -0.007912299,\n                -0.019731745,\n                0.016085945,\n                -0.020071497,\n                0.037660193,\n                0.0039790175,\n                -0.016856922,\n                0.041345194,\n                -0.0031590394,\n                0.014674669,\n                -0.023011658,\n                0.0004904351,\n                0.010205625,\n                0.0065761595,\n                0.012211467,\n                -0.013733817,\n                0.027232422,\n                -0.01605981,\n                0.0068277065,\n                -0.039594162,\n                0.00683424,\n                0.031858273,\n                -0.015406442,\n                0.007245863,\n                0.0023945975,\n                -0.009565323,\n                -0.020581124,\n                -0.0012520184,\n                0.0005112613,\n                0.011159543,\n                -0.0016391396,\n                -0.008624472,\n                0.03666707,\n                -0.019052241,\n                -0.023233803,\n                -0.0040247533,\n                0.01701373,\n                0.021678785,\n                -0.009565323,\n                0.012172265,\n                0.026565986,\n                0.012348675,\n                -0.015118959,\n                0.0007456574,\n                0.014230378,\n                0.006494488,\n                -0.02558593,\n                0.005079944,\n                -0.033452496,\n                0.004132559,\n                -0.01262309,\n                0.032459375,\n                -0.0019846084,\n                0.018542614,\n                -0.011551565,\n                0.007448407,\n                -0.010669516,\n                0.022841781,\n                -0.0034301875,\n                -0.0075464123,\n                -0.008382725,\n                -0.00020203396,\n                -0.009689463,\n                0.020097632,\n                -0.016687045,\n                -0.009421581,\n                -0.007899231,\n                0.005811718,\n                0.013759952,\n                -0.024383733,\n                -0.04659828,\n                0.003092069,\n                0.013204589,\n                -0.035386465,\n                0.011917451,\n                0.1841978,\n                0.014543995,\n                -0.0072066607,\n                0.03985551,\n                0.020045362,\n                -0.008363124,\n                0.008317388,\n                0.012178799,\n                0.000707272,\n                0.006945313,\n                0.014504793,\n                0.022580434,\n                0.008049507,\n                -0.0018212663,\n                0.0140213,\n                -0.025050169,\n                -0.032694586,\n                -0.014909881,\n                -0.011682238,\n                -0.023416746,\n                -0.011492762,\n                0.0042534326,\n                -0.030159514,\n                0.013407133,\n                0.020541923,\n                0.01671318,\n                -0.01317192,\n                0.0025612067,\n                0.016203552,\n                0.03316501,\n                -0.005086478,\n                -0.027467635,\n                0.0015231665,\n                0.0034269206,\n                0.008049507,\n                -0.016477967,\n                -0.0036490662,\n                -0.015824597,\n                0.0020107431,\n                0.0043808394,\n                -0.0076052155,\n                -0.013524739,\n                0.023286073,\n                -0.014818409,\n                -0.023377545,\n                0.001635056,\n                -0.017732436,\n                0.0051844832,\n                -0.0008730644,\n                0.009944277,\n                -0.028121004,\n                -0.017235875,\n                0.019195983,\n                0.010257894,\n                0.0067035663,\n                -0.019391993,\n                0.023233803,\n                0.009408514,\n                0.0010347732,\n                0.01981015,\n                -0.0147530725,\n                0.026461447,\n                -0.032616183,\n                0.027363095,\n                -0.016556371,\n                0.009669862,\n                0.00053617096,\n                0.0039986186,\n                0.0103362985,\n                0.013577009,\n                0.011296751,\n                -0.01835967,\n                -0.01048004,\n                -0.006158003,\n                0.005756181,\n                -0.033635437,\n                0.0052465536,\n                0.03617051,\n                -0.005501367,\n                0.031361714,\n                -0.004828397,\n                0.033739977,\n                0.0020042094,\n                0.020777136,\n                -0.028303947,\n                -0.018712489,\n                -0.002860123,\n                0.0066022943,\n                0.021365168,\n                -0.00982667,\n                -0.0025138373,\n                -0.007762024,\n                -0.0053380253,\n                -0.010388568,\n                0.014230378,\n                0.010166422,\n                0.0044657774,\n                0.0249979,\n                0.01981015,\n                -0.0164649,\n                -0.008748611,\n                0.024383733,\n                -0.013335262,\n                0.012943241,\n                -0.016830787,\n                -0.011126875,\n                -0.020659529,\n                0.0068015717,\n                0.018150592,\n                -0.000993121,\n                0.0003850794,\n                -0.017392684,\n                -0.0060959333,\n                0.0023472284,\n                0.020398181,\n                0.040247533,\n                0.011656104,\n                -0.0067101,\n                0.022292951,\n                -0.0050178743,\n                0.016843854,\n                -0.022110008,\n                0.0116169015,\n                0.010231759,\n                0.010760988,\n                0.0002356212,\n                -0.009682929,\n                0.010571511,\n                0.008016838,\n                -0.020398181,\n                0.0040182197,\n                -0.014452524,\n                -0.024422934,\n                -0.018281266,\n                0.0022671905,\n                0.0022279883,\n                0.0046977233,\n                0.011126875,\n                -0.013145785,\n                -0.00074810756,\n                -0.009225571,\n                0.003652333,\n                -0.019352792,\n                0.014726938,\n                0.02175719,\n                -0.034942176,\n                0.019548802,\n                -0.014478658,\n                0.011035403,\n                -0.0077750916,\n                -0.00865714,\n                0.010989667,\n                -0.0011703473,\n                0.006755836,\n                -0.014909881,\n                -0.015524048,\n                -0.019744812,\n                -0.04429842,\n                -0.0018000318,\n                0.0012119996,\n                -0.0524786,\n                0.0049917395,\n                0.012466282,\n                -0.0068538412,\n                -0.024684282,\n                -0.014635467,\n                -0.16381268,\n                0.03177987,\n                0.008199781,\n                -0.014596265,\n                0.014060502,\n                -0.009650261,\n                0.031701464,\n                0.009643727,\n                -0.02469735,\n                -0.0064879544,\n                0.020267507,\n                -0.014818409,\n                -0.021273697,\n                -0.0329298,\n                0.025259247,\n                -0.010878595,\n                0.01970561,\n                0.019601071,\n                -0.0068277065,\n                -0.00088286493,\n                0.023246871,\n                -0.005145281,\n                0.020777136,\n                -0.0030659342,\n                0.026500648,\n                0.017340414,\n                -0.0046552545,\n                -0.024070116,\n                0.0045703165,\n                0.009297442,\n                0.0035118586,\n                -0.029558415,\n                0.021221427,\n                -0.004534381,\n                0.0091210315,\n                -0.018320467,\n                0.0038320094,\n                0.015406442,\n                -0.015053622,\n                0.011878249,\n                0.009023027,\n                0.02799033,\n                0.051354807,\n                0.011296751,\n                -0.00007825115,\n                -0.0124270795,\n                -0.0013500238,\n                -0.013511672,\n                0.00051330304,\n                -0.0137076825,\n                0.0147530725,\n                -0.028669834,\n                0.02733696,\n                0.022972455,\n                0.02115609,\n                -0.0073961373,\n                0.0141127715,\n                0.01717054,\n                -0.0042566992,\n                -0.029035721,\n                -0.009584924,\n                -0.0029074922,\n                0.01471387,\n                -0.01841194,\n                -0.024971765,\n                -0.0329298,\n                -0.038444236,\n                0.0018849696,\n                -0.035438735,\n                0.0012953042,\n                0.0025105705,\n                0.014125839,\n                0.0060992,\n                -0.0030904356,\n                -0.0017052932,\n                0.017444953,\n                -0.029845897,\n                0.023076994,\n                -0.004818597,\n                -0.0147530725,\n                0.011930519,\n                0.019039175,\n                -0.021234494,\n                -0.0068015717,\n                -0.003838543,\n                -0.016621709,\n                0.0084807305,\n                0.007742423,\n                0.008670207,\n                0.018438075,\n                0.01274723,\n                -0.003134538,\n                0.010525775,\n                -0.021587312,\n                0.0084807305,\n                0.026761996,\n                0.012806033,\n                0.012263737,\n                0.035229657,\n                0.019692542,\n                -0.0013818755,\n                -0.006122068,\n                -0.0256382,\n                0.028852778,\n                0.027728982,\n                0.018255131,\n                0.022671906,\n                0.013152319,\n                0.0072981324,\n                -0.021861728,\n                -0.030969692,\n                0.016739314,\n                0.023390612,\n                -0.00050105236,\n                -0.039724838,\n                0.007977636,\n                -0.009173301,\n                -0.019836284,\n                0.027467635,\n                0.01671318,\n                0.05334105,\n                0.0023080262,\n                -0.012113462,\n                -0.0024092984,\n                -0.014883746,\n                -0.0009531021,\n                -0.11007962,\n                0.006925712,\n                -0.017850041,\n                0.010172956,\n                -0.013407133,\n                0.0022622903,\n                0.00095146865,\n                0.0070171836,\n                -0.011035403,\n                0.014661602,\n                0.028983451,\n                -0.020489654,\n                -0.014086637,\n                -0.0080103045,\n                0.02105155,\n                0.005070144,\n                0.00512568,\n                0.006664364,\n                -0.022606568,\n                -0.010035749,\n                0.007886164,\n                -0.005988127,\n                0.0126296235,\n                0.010414703,\n                -0.028121004,\n                0.0012267004,\n                -0.020280575,\n                -0.0015885035,\n                0.026487581,\n                0.007657485,\n                0.009173301,\n                -0.013165386,\n                0.015837666,\n                -0.03303434,\n                0.020071497,\n                0.020737933,\n                -0.003482457,\n                -0.027049478,\n                0.026069425,\n                -0.031962812,\n                0.0140213,\n                -0.0005443381,\n                0.0016203552,\n                -0.018764758,\n                -0.0069583803,\n                -0.00016160675,\n                -0.0032358102,\n                0.024161587,\n                0.031466253,\n                0.00016324017,\n                -0.006906111,\n                0.0142826475,\n                -0.0140213,\n                -0.017732436,\n                0.0433053,\n                0.02174412,\n                -0.009990012,\n                0.0059391246,\n                -0.010760988,\n                -0.02214921,\n                -0.02480189,\n                -0.0013924928,\n                -0.015994474,\n                -0.0046715885,\n                0.00019345849,\n                0.022920186,\n                -0.037242036,\n                -0.0041684946,\n                0.0064226175,\n                -0.020489654,\n                -0.0070563857,\n                0.008827016,\n                -0.01910451,\n                0.016647844,\n                -0.028330082,\n                -0.00060395803,\n                0.008670207,\n                -0.027467635,\n                0.008644072,\n                -0.0010274228,\n                -0.012610023,\n                -0.0030855353,\n                -0.004893734,\n                -0.024658147,\n                0.007422272,\n                0.0072981324,\n                0.023259938,\n                0.025612066,\n                0.018320467,\n                -0.034785368,\n                0.014909881,\n                -0.004812063,\n                0.010153355,\n                0.0039332816,\n                -0.0113816885,\n                0.005334758,\n                -0.021025416,\n                0.0028013198,\n                0.028931182,\n                0.018895432,\n                -0.005700645,\n                -0.021521976,\n                -0.058750942,\n                0.022384424,\n                0.020568058,\n                -0.00780776,\n                0.019875485,\n                -0.020646462,\n                0.021861728,\n                -0.006814639,\n                0.018398872,\n                0.009441183,\n                -0.020685663,\n                0.026657457,\n                -0.014151974,\n                -0.007402671,\n                -0.015955271,\n                -0.0268404,\n                0.024605878,\n                -0.011969721,\n                0.026004087,\n                0.02953228,\n                0.018803962,\n                0.0237957,\n                0.026657457,\n                0.045317676,\n                0.0040182197,\n                0.0360137,\n                -0.005654909,\n                0.020868607,\n                -0.0061318683,\n                -0.016817719,\n                -0.00004890059,\n                -0.032041218,\n                0.0056091733,\n                0.024070116,\n                -0.01676545,\n                -0.007428806,\n                0.009722131,\n                0.012890971,\n                -0.005145281,\n                -0.0042534326,\n                -0.024279194,\n                -0.016909191,\n                -0.00037160364,\n                -0.049473103,\n                -0.040744092,\n                -0.016321158,\n                -0.022110008,\n                -0.016778518,\n                0.03068221,\n                -0.00805604,\n                0.017235875,\n                0.01915678,\n                -0.031962812,\n                -0.013955963,\n                -0.007997237,\n                -0.016477967,\n                0.022528164,\n                0.0031557726,\n                0.0029401607,\n                -0.028983451,\n                0.010042282,\n                -0.015759261,\n                0.006879976,\n                -0.016138215,\n                -0.015772328,\n                0.024488272,\n                0.013184987,\n                -0.0076444177,\n                0.031413984,\n                -0.019339724,\n                -0.019888554,\n                0.008343522,\n                0.0049525374,\n                -0.020594193,\n                -0.0008261035,\n                -0.009023027,\n                -0.027180152,\n                -0.008539533,\n                -0.030499266,\n                0.007762024,\n                -0.009434649,\n                -0.00341712,\n                -0.025010968,\n                0.050361685,\n                0.04847998,\n                -0.011603834,\n                -0.011335953,\n                0.004998273,\n                0.008140978,\n                -0.009336644,\n                -0.035360333,\n                -0.0042991685,\n                0.0063050115,\n                0.0031361715,\n                0.014243445,\n                0.006683965,\n                -0.008729011,\n                0.029819762,\n                0.029401606,\n                -0.008702876,\n                -0.003756872,\n                0.0057594483,\n                -0.008173646,\n                -0.0073373346,\n                -0.0078730965,\n                -0.004936203,\n                -0.006393216,\n                -0.03217189,\n                0.010212158,\n                0.014609332,\n                0.02474962,\n                -0.021887863,\n                0.010329764,\n                -0.008742078,\n                -0.012806033,\n                0.004730392,\n                -0.0038777452,\n                -0.0060959333,\n                -0.012551219,\n                -0.0010102718,\n                0.02280258,\n                0.01846421,\n                0.03018565,\n                -0.0014022933,\n                0.005419696,\n                -0.0022786246,\n                -0.0031280043,\n                -0.033635437,\n                0.0041488935,\n                -0.012518551,\n                -0.030969692,\n                -0.04351438,\n                -0.0019568403,\n                0.004714058,\n                -0.0072066607,\n                -0.002531805,\n                -0.005275955,\n                0.00658596,\n                -0.0046062516,\n                0.053994417,\n                0.025259247,\n                0.01476614,\n                -0.017379617,\n                0.0059195235,\n                0.006063265,\n                0.025520595,\n                0.006563092,\n                -0.029950436,\n                -0.00046715885,\n                -0.0029205596,\n                -0.015720058,\n                0.035438735,\n                0.004403707,\n                -0.006242941,\n                -0.0018768025,\n                -0.026944939,\n                0.022214547,\n                -0.0066349627,\n                0.0057790494,\n                0.011910917,\n                0.00591299,\n                0.0057953834,\n                -0.018294333,\n                0.0038875458,\n                0.0014120939,\n                0.018738624,\n                -0.020672597,\n                0.0053314916,\n                -0.028382352,\n                0.009428116,\n                0.022083873,\n                -0.023259938,\n                -0.016151283,\n                -0.010140288,\n                0.010682584,\n                -0.012877904,\n                0.010937397,\n                -0.009885473,\n                0.0033909853,\n                -0.008598337,\n                0.019574936,\n                -0.0058607203,\n                0.017196674,\n                0.0026314438,\n                0.007611749,\n                0.0047663273,\n                -0.021208359,\n                -0.017980715\n            ]\n    }\n  }\n}", null, "application/json");
            var content = new StringContent(customerJson, null, "application/json");
            request.Content = content;
            var response = await client.SendAsync(request);
            response.EnsureSuccessStatusCode();
            Console.WriteLine(await response.Content.ReadAsStringAsync());

        }
    }

    public class Document
    {
        public string _id { get; set; }
        public string company { get; set; }

        [JsonProperty("$vector")]
        public List<double> vector { get; set; }
    }

    public class InsertOne
    {
        public Document document { get; set; } = new Document();
    }

    public class Customer
    {
        public InsertOne insertOne { get; set; } = new InsertOne();

        public Customer(string id, string company, List<double> vector)
        {
            this.insertOne.document._id = id;
            this.insertOne.document.company = company;
            this.insertOne.document.vector = vector;
        }
    }

}
