using Newtonsoft.Json;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace RAG.DataStax
{
    internal class API
    {
        public async Task CreateCollectionAsync(string  collectionName)
        {
            var client = new HttpClient();
            var request = new HttpRequestMessage(HttpMethod.Post, "https://953ccde9-fa5a-4634-a3a9-31d41d3bfb33-us-east1.apps.astra.datastax.com/api/json/v1/default_keyspace");
            request.Headers.Add("Token", "AstraCS:jBqdQovblyPQlWIgBZtsGEws:aa14ebbbcd7f99d3f419f9ae56439cacd776bbc0bf20892e654a42a72a187879");
            var content = new StringContent("{\n  \"createCollection\": {\n    \"name\": \"" + collectionName + "\",\n    \"options\" : {\n      \"vector\" : {\n        \"dimension\" : 1536,\n        \"metric\" : \"cosine\"\n      }\n    }\n  }\n}", null, "application/json");
            request.Content = content;
            var response = await client.SendAsync(request);
            response.EnsureSuccessStatusCode();
            Console.WriteLine(await response.Content.ReadAsStringAsync());

        }

        public async Task<FindResult> FindAsync(FindRequest findRequest)
        {
            string findJson = JsonConvert.SerializeObject(findRequest);

            var client = new HttpClient();
            var request = new HttpRequestMessage(HttpMethod.Post, "https://953ccde9-fa5a-4634-a3a9-31d41d3bfb33-us-east1.apps.astra.datastax.com/api/json/v1/default_keyspace/customer");
            request.Headers.Add("Token", "AstraCS:jBqdQovblyPQlWIgBZtsGEws:aa14ebbbcd7f99d3f419f9ae56439cacd776bbc0bf20892e654a42a72a187879");
            //var content = new StringContent("{\n    \"find\": {\n        \"sort\": {\n            \"$vector\": [\n                -0.021822264,\n                -0.02588811,\n                0.0032560097,\n                -0.012044236,\n                -0.0075451443,\n                0.036765914,\n                0.0074251685,\n                -0.026661288,\n                -0.00755181,\n                -0.009584732,\n                0.010424564,\n                -0.006435368,\n                0.015383563,\n                0.0018862861,\n                0.011577664,\n                -0.014037168,\n                0.04327127,\n                -0.00080567074,\n                0.014690369,\n                -0.012544136,\n                -0.0028710873,\n                -0.01573016,\n                0.034686334,\n                -0.00032930856,\n                0.00026244705,\n                0.009658052,\n                0.025514852,\n                -0.02567482,\n                0.017236521,\n                -0.025501521,\n                0.05444235,\n                0.00049698306,\n                -0.012544136,\n                -0.013957184,\n                -0.019169465,\n                0.011551003,\n                0.0060787736,\n                -0.00024140962,\n                0.020822465,\n                -0.012304184,\n                0.021369021,\n                -0.008731572,\n                0.010737834,\n                -0.018436281,\n                -0.015356901,\n                0.014570394,\n                -0.013983845,\n                -0.017663103,\n                -0.017103216,\n                0.016316708,\n                0.0028310954,\n                0.0022812064,\n                -0.0013980513,\n                -0.0012414162,\n                -0.014277119,\n                0.0035359531,\n                0.002797769,\n                0.03628601,\n                0.00993133,\n                -0.0057221786,\n                -0.004522421,\n                0.0068652816,\n                -0.015383563,\n                0.0063753803,\n                -0.0053755823,\n                0.0077917613,\n                -0.0031893565,\n                0.015876796,\n                0.004562413,\n                0.015010305,\n                0.019756014,\n                0.037352465,\n                -0.010717837,\n                0.013190672,\n                0.015183603,\n                -0.028314287,\n                -0.020049289,\n                -0.0012489146,\n                0.007331854,\n                -0.0037825701,\n                0.011244398,\n                -0.028474255,\n                -0.026687948,\n                0.024981625,\n                0.008105031,\n                -0.0036092717,\n                0.024075143,\n                -0.005552213,\n                -0.02340861,\n                -0.028367609,\n                -0.020555852,\n                0.021888917,\n                0.013137349,\n                0.013930523,\n                -0.0135972565,\n                0.011977583,\n                -0.022102207,\n                0.023515256,\n                -0.010037974,\n                -0.004139165,\n                -0.004905677,\n                0.0026844584,\n                -0.02503495,\n                -0.008858212,\n                -0.012810748,\n                -0.0011322715,\n                -0.008998184,\n                -0.01987599,\n                0.018782876,\n                -0.037219156,\n                -0.032180175,\n                0.0069719264,\n                0.00703858,\n                -0.052389428,\n                0.011191076,\n                -0.014463748,\n                -0.012164212,\n                -0.008138358,\n                0.0043291263,\n                -0.0009273129,\n                0.019036159,\n                -0.025128264,\n                0.04372451,\n                0.013957184,\n                0.011930926,\n                -0.011677644,\n                -0.03911211,\n                0.016010104,\n                -0.008544942,\n                -0.0039858622,\n                0.01740982,\n                0.014263788,\n                0.026594633,\n                -0.01232418,\n                -0.030927094,\n                0.028047673,\n                -0.010184612,\n                -0.029274093,\n                -0.03295335,\n                0.0017979705,\n                1.0284383E-05,\n                0.010237934,\n                0.016076757,\n                -0.023888513,\n                -0.0343664,\n                0.008384975,\n                0.021249047,\n                -0.004755707,\n                -0.008111697,\n                -0.011471019,\n                0.0048790155,\n                -0.0065520112,\n                -0.012744095,\n                0.0032210168,\n                0.014983644,\n                0.029247433,\n                -0.0323668,\n                0.023301965,\n                -0.02919411,\n                -0.016729958,\n                -0.0022378818,\n                -0.021062417,\n                0.006025451,\n                -0.03087377,\n                -0.025914771,\n                0.018689562,\n                0.016609982,\n                -0.014477079,\n                -0.003479298,\n                0.016170071,\n                0.017929716,\n                0.02860756,\n                0.00954474,\n                0.032446787,\n                -0.008371644,\n                0.027247835,\n                -0.016956579,\n                0.002752778,\n                -0.018929513,\n                0.013084027,\n                0.0038258948,\n                0.008511616,\n                0.021155732,\n                0.01678328,\n                -0.0063320557,\n                0.010364575,\n                0.018196328,\n                -0.0019079484,\n                -0.004549082,\n                -0.020329231,\n                -0.005465564,\n                -0.008191681,\n                -0.011277724,\n                -0.013757224,\n                -0.66247964,\n                -0.011064434,\n                0.011217737,\n                0.0010397902,\n                0.028234303,\n                0.009678047,\n                -0.01252414,\n                0.027861046,\n                -0.012444156,\n                0.022888714,\n                -0.00911816,\n                0.0058621503,\n                -0.02815432,\n                -0.008564939,\n                0.021662297,\n                -0.019596046,\n                0.016543329,\n                -0.030153915,\n                0.002752778,\n                -0.011970918,\n                -0.0102712605,\n                0.006498689,\n                -0.013997176,\n                0.01678328,\n                0.019476071,\n                -0.013630583,\n                0.0057055154,\n                -0.01986266,\n                0.015343571,\n                0.02526157,\n                -0.020355893,\n                0.029220771,\n                0.0023528587,\n                -0.004539084,\n                0.055348832,\n                -0.015943449,\n                -0.010057971,\n                0.015410224,\n                -0.018103015,\n                0.020062618,\n                -0.008225007,\n                -0.0026911236,\n                0.018702893,\n                -0.0070119184,\n                -0.008111697,\n                -0.0023611903,\n                0.02570148,\n                0.004775703,\n                0.0012089227,\n                0.0115176765,\n                0.02010261,\n                0.0036725923,\n                -0.011730966,\n                -0.015476877,\n                -0.00040283537,\n                -0.025114933,\n                0.022102207,\n                -0.013164011,\n                -0.008864878,\n                0.022675425,\n                0.0051289652,\n                0.028021013,\n                -0.018262982,\n                -0.013810547,\n                -0.006298729,\n                -0.013330644,\n                -0.04868351,\n                0.016036764,\n                -0.0013005709,\n                0.0024861651,\n                0.009651386,\n                0.013917192,\n                -0.012184208,\n                0.01906282,\n                0.019609377,\n                0.025594836,\n                -0.006958596,\n                -0.01253747,\n                -0.0021412347,\n                -0.00890487,\n                -0.0008706577,\n                -0.0035892758,\n                0.007838419,\n                -0.033059996,\n                0.026154723,\n                0.018396288,\n                -0.039245415,\n                -0.028021013,\n                0.0039758645,\n                -0.0055255517,\n                0.014810345,\n                0.017663103,\n                0.012917394,\n                -0.038872156,\n                -0.005982126,\n                0.00616209,\n                -0.01510362,\n                0.00078192557,\n                0.018969506,\n                -0.005405576,\n                0.0057255113,\n                -0.010324583,\n                0.00012674526,\n                0.0034826307,\n                0.008118362,\n                -0.0013980513,\n                -0.012970716,\n                0.02094244,\n                0.025021618,\n                -0.009904668,\n                -0.0008798225,\n                -0.010837813,\n                -0.0060487795,\n                0.0041824896,\n                0.007331854,\n                -0.027861046,\n                -0.0030393868,\n                -0.0039158766,\n                0.006052112,\n                -0.02919411,\n                -0.0028794191,\n                0.009344781,\n                0.025808126,\n                -0.014157143,\n                0.018982837,\n                0.0037192495,\n                -0.016529998,\n                0.005638862,\n                -0.005692185,\n                -0.019036159,\n                0.0027294492,\n                -0.0005723845,\n                0.003812564,\n                -0.01739649,\n                0.024901642,\n                0.011444357,\n                -0.0012180875,\n                0.0007881743,\n                0.015036966,\n                -0.0068452857,\n                -0.017716425,\n                -0.022968698,\n                -0.0012597458,\n                -0.00010206274,\n                -0.008484955,\n                -0.019529393,\n                -0.0028477588,\n                0.002404515,\n                -0.011650982,\n                -0.005965463,\n                -0.0009698043,\n                -0.00075609743,\n                -0.01780974,\n                0.00065111864,\n                -0.002722784,\n                -0.030500513,\n                0.0085916,\n                -0.033459917,\n                -0.00016038431,\n                -0.010237934,\n                0.017743086,\n                0.0068452857,\n                -0.014757022,\n                0.010491217,\n                -0.022595441,\n                -0.0070452453,\n                -0.0033243292,\n                0.025621496,\n                0.0026394674,\n                -0.020342562,\n                -0.0061254306,\n                -0.009758031,\n                -0.022942038,\n                -0.00071235624,\n                0.0068652816,\n                0.001911281,\n                0.0047123823,\n                0.0072985273,\n                -0.02916745,\n                0.010697842,\n                0.012904063,\n                0.002182893,\n                -0.008051708,\n                0.025781464,\n                0.028874174,\n                0.009091499,\n                5.342672E-05,\n                0.013517273,\n                -0.0110711,\n                0.0125574665,\n                -0.0041691586,\n                0.026394675,\n                -0.014770353,\n                0.016823273,\n                0.013743893,\n                0.0022112206,\n                -0.001739649,\n                0.0021845591,\n                0.0004907343,\n                0.010297922,\n                0.0203159,\n                -0.015303579,\n                0.03996527,\n                -0.016036764,\n                0.011664313,\n                -0.019156136,\n                0.016436683,\n                -0.03087377,\n                0.018796207,\n                0.009971322,\n                -0.008331652,\n                -0.020982433,\n                0.009164818,\n                0.0014780351,\n                0.020022627,\n                0.00881822,\n                -0.004469098,\n                0.030820448,\n                -0.027834384,\n                -0.005888812,\n                0.0040958403,\n                0.004199153,\n                0.010124624,\n                -0.006705314,\n                -0.0221422,\n                0.022502126,\n                0.0020445874,\n                0.0227954,\n                0.019102812,\n                -0.0043791165,\n                -0.012470817,\n                -0.011557668,\n                0.013184006,\n                -0.0020079282,\n                0.0070519103,\n                -0.024901642,\n                -0.005012322,\n                -0.018156337,\n                0.030393867,\n                -0.0006223744,\n                0.0015421888,\n                0.0041291667,\n                -0.0034326408,\n                -0.020115942,\n                0.04863019,\n                -0.0010872806,\n                0.01615674,\n                0.012070898,\n                -0.004305798,\n                0.0034559693,\n                -0.02216886,\n                0.015356901,\n                -0.022502126,\n                -0.018782876,\n                -0.016663304,\n                -0.031566963,\n                0.001956272,\n                0.00019652284,\n                0.017849732,\n                0.026394675,\n                0.010004648,\n                0.018942844,\n                0.029727336,\n                -0.010711173,\n                0.012624119,\n                0.013537268,\n                0.0022562114,\n                0.0030977083,\n                -0.006485358,\n                0.0015563526,\n                -0.009838015,\n                0.016809942,\n                0.009964656,\n                -0.009224805,\n                0.019702692,\n                -0.0035159572,\n                0.012090893,\n                0.014157143,\n                0.010917797,\n                0.009144821,\n                0.004602405,\n                -0.02607474,\n                0.009278128,\n                0.019436078,\n                -0.019302772,\n                -0.0068452857,\n                -0.02322198,\n                0.023275305,\n                -0.040471833,\n                0.01760978,\n                -0.007831753,\n                0.014183804,\n                -0.026674617,\n                -0.0026244705,\n                -0.009471422,\n                0.009871341,\n                0.021902248,\n                -0.022635432,\n                0.041351657,\n                -0.022595441,\n                -0.0010714505,\n                -0.00054905587,\n                -0.011917596,\n                -0.034659673,\n                0.007478491,\n                0.0013222332,\n                -0.004765705,\n                -0.039032124,\n                -0.004235812,\n                -0.030687142,\n                0.0019329434,\n                0.017556457,\n                0.009184813,\n                0.00030223068,\n                0.008125028,\n                -0.015903458,\n                -0.009684713,\n                0.011990914,\n                0.047777027,\n                -0.0032893363,\n                -0.005465564,\n                -0.016503336,\n                -0.015810143,\n                0.0010381239,\n                0.09694044,\n                0.015490208,\n                -0.010617858,\n                0.008871543,\n                0.006498689,\n                0.017996369,\n                0.015410224,\n                -0.017876392,\n                0.023022022,\n                -0.0051056365,\n                0.011650982,\n                -0.0069519305,\n                -0.010637853,\n                0.005538882,\n                -0.015943449,\n                0.0038592212,\n                -0.004829026,\n                -0.0058354894,\n                -0.020742482,\n                -0.023155328,\n                -0.017436482,\n                0.021035755,\n                0.015876796,\n                0.02690124,\n                0.03047385,\n                0.02756777,\n                0.008011716,\n                0.024381747,\n                0.002566149,\n                -0.014983644,\n                -0.022462135,\n                0.019182796,\n                -0.005575542,\n                0.011557668,\n                -0.016836602,\n                0.0013372302,\n                -0.008471624,\n                0.021635635,\n                0.010824483,\n                0.023022022,\n                -0.004002526,\n                0.002576147,\n                0.0058121607,\n                0.003394315,\n                0.020555852,\n                -0.016130079,\n                0.006378713,\n                0.011710971,\n                0.0015438552,\n                -0.015716828,\n                0.00440911,\n                0.016450014,\n                -0.018089684,\n                -0.029913964,\n                -0.011984249,\n                -0.004402445,\n                -0.023048682,\n                -0.019182796,\n                -0.022902045,\n                0.005155626,\n                -0.01179762,\n                0.0064820256,\n                0.021075748,\n                -0.0035726125,\n                -0.017263183,\n                -0.031406995,\n                -0.023688553,\n                0.0069052735,\n                -0.006818624,\n                -0.02008928,\n                -0.007491822,\n                -0.02607474,\n                0.0076384586,\n                0.007805092,\n                0.017943047,\n                -0.011277724,\n                0.02236882,\n                -0.009838015,\n                -0.017489804,\n                -0.009971322,\n                -0.003765907,\n                -0.028260965,\n                0.015170272,\n                -0.025594836,\n                -0.021075748,\n                0.015876796,\n                0.0038892152,\n                -0.007211878,\n                0.0023078676,\n                0.023941835,\n                0.025741473,\n                0.020009296,\n                0.02174228,\n                -0.035326205,\n                -0.002769441,\n                0.008318322,\n                0.018396288,\n                0.024368417,\n                -0.005708848,\n                -0.017516466,\n                -0.021462336,\n                -0.036872562,\n                0.023515256,\n                -0.017116547,\n                -0.022608772,\n                0.019649368,\n                0.040471833,\n                0.018556256,\n                -0.0118042845,\n                -0.010191277,\n                0.017049894,\n                0.0005315594,\n                0.00470905,\n                0.007438499,\n                0.0034326408,\n                0.04353788,\n                0.021888917,\n                -0.0070252493,\n                0.004352455,\n                -0.019702692,\n                -0.021888917,\n                -0.028180981,\n                0.0133773,\n                0.003892548,\n                -0.027647754,\n                -0.0012422494,\n                0.010151285,\n                -0.031353675,\n                0.020382553,\n                -0.00088482146,\n                -0.015450216,\n                -0.00079234014,\n                -0.020355893,\n                -0.030420529,\n                -0.010237934,\n                -0.009957991,\n                -0.006555344,\n                0.02919411,\n                -0.00599879,\n                -0.014037168,\n                -0.022475464,\n                -0.011784289,\n                -0.01760978,\n                -0.017916385,\n                -0.0052656042,\n                -0.03250011,\n                -0.026807925,\n                0.013643914,\n                -0.007091902,\n                0.0043624532,\n                -0.022822062,\n                0.011417696,\n                -0.012097559,\n                -0.004539084,\n                -0.015996773,\n                -0.014583725,\n                0.0044857617,\n                0.020809134,\n                0.031540304,\n                0.020169264,\n                0.042498093,\n                0.02071582,\n                0.01014462,\n                0.021822264,\n                -0.01199758,\n                -0.020462537,\n                -0.0056555257,\n                -0.0071985475,\n                -0.013064031,\n                0.029327417,\n                0.024461731,\n                0.011937591,\n                0.011917596,\n                -0.008531612,\n                0.0001795471,\n                0.019809335,\n                -0.004835691,\n                -0.032206833,\n                -0.013690571,\n                -0.045030914,\n                0.0077717653,\n                0.011417696,\n                0.004679056,\n                0.009718039,\n                -0.012977381,\n                -0.014317111,\n                0.01357726,\n                -0.018129675,\n                0.017143209,\n                -0.019716023,\n                0.0028960824,\n                0.0033109987,\n                0.016130079,\n                -0.012250861,\n                0.01658332,\n                -0.00019506481,\n                0.008784894,\n                -0.0037692394,\n                -0.006611999,\n                0.00953141,\n                0.011837612,\n                0.018116344,\n                -0.007225209,\n                0.024715014,\n                -0.017116547,\n                0.006408707,\n                -0.012924059,\n                -0.0072585354,\n                0.0010472886,\n                0.015583523,\n                -0.009124826,\n                -0.0048423563,\n                -0.022382151,\n                0.0017946379,\n                0.015370232,\n                -0.0031793586,\n                -0.033833172,\n                0.013117353,\n                0.016929917,\n                -0.0203159,\n                0.0038958807,\n                -0.009438096,\n                0.010837813,\n                0.0060454467,\n                0.018609578,\n                0.023075344,\n                -0.007105233,\n                0.010684511,\n                -0.00024828324,\n                0.029540706,\n                0.005248941,\n                0.0054588984,\n                0.00890487,\n                -0.013084027,\n                -0.014197135,\n                0.03066048,\n                -0.009258132,\n                -0.014263788,\n                -0.0049156747,\n                0.02068916,\n                0.0039725318,\n                0.010877805,\n                0.003842558,\n                0.009364777,\n                -0.010631188,\n                0.0053555863,\n                0.0006223744,\n                0.001174763,\n                -0.017796408,\n                -0.012490813,\n                -0.037405785,\n                0.023515256,\n                -0.010391236,\n                0.015756821,\n                0.0068452857,\n                0.0062853983,\n                -0.010784491,\n                -0.015410224,\n                -0.0050456487,\n                -0.0044157756,\n                -0.003765907,\n                0.030420529,\n                0.01367724,\n                0.0057555055,\n                -0.01429045,\n                0.009291459,\n                0.0059887916,\n                -0.0102845915,\n                -0.03044719,\n                0.029060803,\n                -0.020329231,\n                -0.004392447,\n                -0.013223998,\n                -0.015396893,\n                -0.00920481,\n                0.0062154126,\n                -0.015636845,\n                0.002339528,\n                0.019942643,\n                0.006681985,\n                0.024808329,\n                0.006808626,\n                -0.036605947,\n                0.004079177,\n                -0.0089848535,\n                -0.001331398,\n                -0.030180577,\n                0.0023911842,\n                -0.015090289,\n                -0.03124703,\n                -0.018809538,\n                -0.014517071,\n                0.02295537,\n                0.026421336,\n                0.018143006,\n                -0.035246223,\n                0.015983442,\n                0.005718846,\n                -0.017343167,\n                0.013757224,\n                0.0076584546,\n                0.008718241,\n                -0.037805706,\n                0.01015795,\n                0.00502232,\n                -0.024834989,\n                0.021635635,\n                -0.0021645632,\n                -0.017449813,\n                -0.015623515,\n                0.002859423,\n                0.0130773615,\n                -0.0046923864,\n                -0.0110511035,\n                0.012564132,\n                0.0032560097,\n                -0.0012722433,\n                -0.00880489,\n                -0.023701884,\n                0.014103821,\n                0.0077917613,\n                0.009598063,\n                -0.005865483,\n                -0.0049490016,\n                0.019422747,\n                -0.0014930321,\n                0.027167851,\n                0.008951527,\n                0.014437087,\n                -0.0044857617,\n                -0.0039592013,\n                0.0051356303,\n                -0.0038692192,\n                -0.01823632,\n                0.0010806153,\n                0.012597458,\n                -0.014743692,\n                0.012364172,\n                0.006282066,\n                0.0070585757,\n                -0.010217939,\n                0.028474255,\n                0.024954965,\n                0.022315497,\n                -0.018289642,\n                -0.0130773615,\n                -0.014130482,\n                -0.01780974,\n                -0.0079583945,\n                -0.0044191084,\n                0.010824483,\n                0.012210869,\n                0.02754111,\n                -0.04364453,\n                -0.011031108,\n                0.0013788885,\n                -0.026767932,\n                0.0009006516,\n                0.016823273,\n                0.0033343271,\n                0.009378108,\n                0.008378309,\n                -0.016436683,\n                0.044017784,\n                0.003735913,\n                -0.010204608,\n                -0.027994351,\n                -0.0049723303,\n                -0.009351446,\n                -0.0036525964,\n                -0.0023045351,\n                -0.020395884,\n                -0.008551608,\n                0.0028310954,\n                0.017289845,\n                0.018103015,\n                0.0073451847,\n                0.020595845,\n                0.013603922,\n                -0.00021662295,\n                -0.007431834,\n                0.008564939,\n                0.024208449,\n                8.362896E-05,\n                0.01511695,\n                -0.025781464,\n                0.007991721,\n                -0.0046423967,\n                -0.010037974,\n                0.0033859834,\n                0.011491015,\n                0.03543285,\n                -0.00954474,\n                0.006135429,\n                -0.020702489,\n                -0.010071301,\n                0.002396183,\n                -0.008498285,\n                0.010411233,\n                -0.0012872403,\n                -0.0069652614,\n                0.006741973,\n                0.015410224,\n                0.0044757635,\n                -0.00025349052,\n                0.0022612105,\n                0.006918604,\n                -0.002471168,\n                0.016943248,\n                -0.024075143,\n                -0.023275305,\n                -0.023755208,\n                -0.0024228445,\n                0.0011139419,\n                -0.00292441,\n                0.02298203,\n                -0.0018812871,\n                -0.008251668,\n                0.009911333,\n                -0.015490208,\n                -0.0045357514,\n                -0.00954474,\n                -0.0102579305,\n                -0.01336397,\n                0.0075784707,\n                -0.041085042,\n                -0.0194894,\n                -0.011171079,\n                -0.006455364,\n                0.01471703,\n                -0.030713802,\n                -0.025328223,\n                0.011524341,\n                0.0077317734,\n                0.036232688,\n                0.011950922,\n                0.25680152,\n                0.0044790963,\n                -0.021582313,\n                0.02464836,\n                0.012070898,\n                0.007818422,\n                0.03937872,\n                -0.0014613718,\n                -0.021888917,\n                -0.019542724,\n                0.023541916,\n                0.011504346,\n                -0.04492427,\n                -0.004569078,\n                -0.0075918017,\n                0.00075818034,\n                -0.03991195,\n                0.004755707,\n                -0.009131491,\n                -0.015196933,\n                0.009331451,\n                0.016450014,\n                -0.0084782895,\n                -0.009791357,\n                0.040845092,\n                0.01265078,\n                -0.0030043938,\n                -0.0065486785,\n                0.009724705,\n                0.00033139146,\n                0.0045657456,\n                0.002162897,\n                0.0013772221,\n                0.002707787,\n                -0.00094480935,\n                -0.013650579,\n                0.025821457,\n                -0.035539497,\n                0.004025854,\n                0.010591196,\n                -5.837364E-05,\n                0.005552213,\n                -0.022862054,\n                -0.000766512,\n                0.006182086,\n                -0.008744902,\n                -0.024368417,\n                0.0012464152,\n                -0.01804969,\n                0.014797014,\n                -0.03252677,\n                -0.023608569,\n                0.03292669,\n                0.025128264,\n                0.0082183415,\n                -0.01927611,\n                -0.0032460117,\n                -0.020835796,\n                0.005368917,\n                -0.0005628031,\n                -0.0085916,\n                0.032873366,\n                0.006878612,\n                0.027181182,\n                -0.0110244425,\n                0.0005557212,\n                0.0035059592,\n                0.018143006,\n                -0.00889154,\n                -0.004139165,\n                -0.014050499,\n                -0.004719048,\n                0.009878007,\n                0.020875787,\n                -0.027194513,\n                -0.00046615594,\n                0.014530402,\n                0.022155529,\n                0.01804969,\n                0.021275707,\n                0.014797014,\n                -0.0039358726,\n                0.021462336,\n                0.00642537,\n                -0.02339528,\n                0.00079442305,\n                -0.014810345,\n                0.01014462,\n                -0.013230664,\n                0.0059887916,\n                0.0028694212,\n                -0.011524341,\n                0.0021362356,\n                0.001719653,\n                0.031406995,\n                -0.0027761066,\n                0.0016321706,\n                0.025501521,\n                0.001351394,\n                -0.01108443,\n                -0.0133239785,\n                0.005295598,\n                -0.021915577,\n                0.015583523,\n                -0.015290248,\n                -0.016023433,\n                0.00060946035,\n                -0.007558475,\n                -0.008838217,\n                -0.011077764,\n                -0.0035159572,\n                -0.020862456,\n                0.0030243897,\n                -0.0122841885,\n                -0.003171027,\n                0.002577813,\n                0.006435368,\n                -0.01045789,\n                0.021435674,\n                -0.015983442,\n                0.0055255517,\n                -0.025741473,\n                -0.011977583,\n                -0.014450418,\n                0.024675021,\n                -0.015210264,\n                -0.019382756,\n                -0.0009947993,\n                0.0077117775,\n                -0.0294074,\n                0.021382352,\n                -0.010371241,\n                0.013417292,\n                -0.018676233,\n                -0.00089148676,\n                0.016436683,\n                -0.0062587373,\n                -0.01014462,\n                0.006728642,\n                0.01595678,\n                0.0066953157,\n                -0.022662094,\n                -0.019009497,\n                -0.00920481,\n                0.021582313,\n                -0.014383764,\n                -0.011717636,\n                0.018756216,\n                0.008311656,\n                -0.0028144321,\n                -0.01201091,\n                0.0042691384,\n                -0.009937995,\n                0.011337712,\n                0.017756417,\n                0.0064920234,\n                -0.020395884,\n                -0.027407803,\n                -0.0075451443,\n                -0.008651588,\n                0.01842295,\n                -0.004562413,\n                0.012430825,\n                0.006651991,\n                -0.01356393,\n                -0.03831227,\n                -0.1714854,\n                0.02796769,\n                0.029594028,\n                -0.034313075,\n                0.0068152915,\n                0.0038592212,\n                0.018982837,\n                0.0077184425,\n                -0.0010414565,\n                0.012604124,\n                -0.002536155,\n                0.0015205265,\n                -0.039218754,\n                -0.01760978,\n                -0.0051456285,\n                -0.0006827789,\n                0.013630583,\n                0.0073051928,\n                0.021968901,\n                0.0146370465,\n                0.008471624,\n                0.002264543,\n                -0.007891741,\n                -0.0047590397,\n                0.013243995,\n                -0.015516869,\n                -0.007898406,\n                0.02484832,\n                -0.018289642,\n                0.0044157756,\n                -0.016116748,\n                -0.012230866,\n                -0.0054322374,\n                -0.02898082,\n                -0.007498487,\n                -0.00040408512,\n                0.011491015,\n                -0.0069652614,\n                -0.037139174,\n                0.02507494,\n                0.02898082,\n                0.020462537,\n                0.0046124025,\n                0.015023636,\n                0.017129878,\n                0.021675626,\n                0.0092448015,\n                -0.02466169,\n                0.01265078,\n                -0.01429045,\n                0.0051356303,\n                -0.00074110046,\n                0.0120642325,\n                0.0015238592,\n                0.003192689,\n                -0.00088898727,\n                -0.0007640125,\n                0.015916789,\n                -0.015943449,\n                -0.014237127,\n                -0.0035059592,\n                -0.011617656,\n                0.024715014,\n                -0.028954158,\n                0.0061754207,\n                0.00094230985,\n                -0.020049289,\n                0.009598063,\n                -0.025154924,\n                0.013277321,\n                -0.0013588925,\n                -0.014023837,\n                -0.0055122213,\n                -0.010171281,\n                0.02568815,\n                0.0020262578,\n                -0.014370434,\n                -0.015876796,\n                0.0069052735,\n                0.00043991124,\n                -0.007185217,\n                0.040071916,\n                -0.009584732,\n                0.020262579,\n                -0.004932338,\n                0.014863668,\n                0.0020912448,\n                -0.015423555,\n                -0.015570192,\n                -0.016050095,\n                0.020355893,\n                -0.0046523944,\n                -0.03892548,\n                -0.025194917,\n                0.008238338,\n                0.016010104,\n                0.014450418,\n                0.019582715,\n                0.009598063,\n                0.00816502,\n                0.022235513,\n                -0.0062187454,\n                -0.045484155,\n                0.014037168,\n                0.034846302,\n                0.003459302,\n                -0.000191628,\n                0.023008691,\n                0.010464556,\n                -0.016929917,\n                -0.016196731,\n                0.008051708,\n                0.013610587,\n                0.03975198,\n                0.004499092,\n                0.03274006,\n                0.012077563,\n                -0.00943143,\n                -0.008045044,\n                -0.0061554248,\n                0.029567368,\n                0.033593222,\n                -0.033806514,\n                0.0038058988,\n                0.00030514676,\n                -0.021262376,\n                -0.10125957,\n                -0.027101198,\n                0.018782876,\n                0.011257729,\n                0.018876191,\n                0.015303579,\n                0.0146370465,\n                -0.0005440569,\n                -0.002732782,\n                0.017969707,\n                0.00954474,\n                -0.020929111,\n                -0.0016563325,\n                0.0033659874,\n                0.0022362154,\n                -0.002961069,\n                -0.015850136,\n                -0.009384773,\n                -0.022502126,\n                0.008338317,\n                0.0034726327,\n                -0.0024628364,\n                0.0053522536,\n                0.005542215,\n                0.010497882,\n                -0.0030143918,\n                -0.033673204,\n                0.00901818,\n                0.021648966,\n                -0.010184612,\n                0.0034126448,\n                -0.021608973,\n                0.016063426,\n                -0.0376724,\n                -0.020862456,\n                -0.0024495057,\n                -0.026874578,\n                -0.0044790963,\n                0.027407803,\n                -0.017529797,\n                0.007498487,\n                -0.014890329,\n                0.014583725,\n                -0.05097638,\n                -0.014663708,\n                -0.01987599,\n                -0.031593625,\n                0.02530156,\n                0.004335792,\n                -0.013443954,\n                -0.030713802,\n                0.009044842,\n                -0.028767528,\n                -0.0015513536,\n                0.01034458,\n                -0.01760978,\n                0.004769038,\n                0.008824886,\n                -0.022288837,\n                -0.0057655033,\n                0.0051223,\n                0.013237329,\n                -0.02426177,\n                -0.00021662295,\n                0.031886898,\n                -0.0018746217,\n                -0.017329836,\n                -0.010131289,\n                0.003051051,\n                -0.029274093,\n                0.005192286,\n                0.008631592,\n                -0.030260561,\n                0.021995561,\n                -0.035246223,\n                0.021502329,\n                -0.016303377,\n                -0.026394675,\n                0.029247433,\n                -0.0059487997,\n                -0.013024039,\n                -0.006405374,\n                -0.013044035,\n                -0.019302772,\n                -0.00074568286,\n                0.0155302,\n                -0.01179762,\n                0.018316304,\n                0.008931532,\n                0.0012889066,\n                -0.0074651605,\n                0.02174228,\n                0.015303579,\n                -0.0026711277,\n                -0.0102446,\n                0.018462941,\n                -0.017943047,\n                -0.004729046,\n                0.018582918,\n                0.030260561,\n                -0.010211273,\n                -0.003792568,\n                -0.0609477,\n                0.036179367,\n                0.008038378,\n                -0.023728546,\n                -0.0019179464,\n                -0.023661893,\n                0.013204003,\n                -0.009578068,\n                0.015823474,\n                0.011157748,\n                -0.004105838,\n                0.0016788279,\n                0.010724503,\n                -0.019116143,\n                -0.010497882,\n                0.00054447347,\n                0.015636845,\n                0.008784894,\n                0.027594432,\n                -0.0066486583,\n                -0.00943143,\n                -0.0028011014,\n                0.009638055,\n                0.02588811,\n                0.008378309,\n                0.01253747,\n                -0.003354323,\n                0.004365786,\n                -0.024048481,\n                -0.012517475,\n                -0.004789034,\n                -0.049003445,\n                -0.019636039,\n                0.03817896,\n                0.0003784653,\n                -0.030313883,\n                -0.02008928,\n                0.018502934,\n                -0.015450216,\n                0.029327417,\n                0.007431834,\n                -0.0155302,\n                0.017249852,\n                -0.0058921445,\n                0.013317313,\n                0.01573016,\n                -0.02322198,\n                0.004272471,\n                0.012977381,\n                -0.014956982,\n                0.016423352,\n                0.0042424775,\n                0.014863668,\n                -0.01946274,\n                -0.024874981,\n                -0.043751173,\n                -0.03313998,\n                -0.008438298,\n                -0.0032160177,\n                -0.028314287,\n                -0.000872324,\n                0.008025047,\n                0.01986266,\n                0.011670979,\n                0.007538479,\n                -0.0005707182,\n                0.013503942,\n                0.022728747,\n                0.02010261,\n                -0.017476473,\n                0.005422239,\n                0.02794103,\n                0.015423555,\n                -0.01658332,\n                0.017063225,\n                0.020782473,\n                0.0128307445,\n                0.004582409,\n                -0.0063320557,\n                0.011870938,\n                0.007645124,\n                -0.004965665,\n                -0.025848119,\n                0.0076584546,\n                0.037805706,\n                0.008145023,\n                0.011890934,\n                0.012024241,\n                0.0054089087,\n                0.0007585969,\n                -0.002152899,\n                0.010857809,\n                0.0031043736,\n                0.0038892152,\n                0.025501521,\n                0.020395884,\n                -0.0068252897,\n                -0.008664918,\n                0.022155529,\n                0.01923612,\n                0.011357708,\n                -0.011424362,\n                -0.0011147751,\n                -0.0062853983,\n                -0.021222385,\n                0.01739649,\n                -0.015610184,\n                -0.018169668,\n                0.0008077537,\n                -0.0033676538,\n                0.010864475,\n                0.030127255,\n                -0.00060279504,\n                0.0094914185,\n                -0.007885076,\n                -0.0037692394,\n                -0.005575542,\n                -0.008978188,\n                -0.015996773,\n                -0.0013430624,\n                0.015196933,\n                -0.0004628233,\n                -0.008065039,\n                -0.0039958605,\n                -0.009224805,\n                0.034712996,\n                -0.003942538,\n                -0.0024628364,\n                -0.0065486785,\n                0.009078168,\n                -0.010797821,\n                -0.010764495,\n                -0.028340949,\n                -0.008271664,\n                0.01595678,\n                -0.024888312,\n                0.0017629776,\n                0.005482227,\n                -0.011217737,\n                0.06041448,\n                0.009891338,\n                -0.0163567,\n                -0.004689054,\n                -0.005208949,\n                7.251141E-06,\n                0.012930724,\n                0.005708848,\n                -0.01490366,\n                -0.008664918,\n                -0.0005294765,\n                -0.010317918,\n                0.0023978495,\n                -0.020222586,\n                -0.0074851564,\n                0.020329231,\n                0.018462941,\n                0.0092314705,\n                0.006761969,\n                -0.023328627,\n                0.0027061207,\n                0.025581505,\n                -0.014103821,\n                -0.017716425,\n                -0.015036966,\n                -0.020155933,\n                0.01884953,\n                -0.021582313,\n                -0.0038558887,\n                -0.025168255,\n                -0.00559887,\n                0.02484832,\n                -0.022088876,\n                -0.010184612,\n                -0.0012622454,\n                -0.041538287,\n                -0.013223998,\n                -0.010451225,\n                0.013903861,\n                0.031620286,\n                0.0033576558,\n                0.027274497,\n                -0.01778308,\n                -0.00323768,\n                -0.023048682,\n                -0.011244398,\n                -0.007858414,\n                0.006208747,\n                -0.007018584\n            ]\n        },\n        \"options\": {\n            \"limit\": 1,\n            \"includeSimilarity\": true\n        }\n    }\n}", null, "application/json");
            var content = new StringContent(findJson, null, "application/json");
            request.Content = content;
            try
            {
                //var response = await client.SendAsync(request);
                var response = client.Send(request);
                response.EnsureSuccessStatusCode();
                //Console.WriteLine(await response.Content.ReadAsStringAsync());
                FindResult fr = JsonConvert.DeserializeObject<FindResult>(await response.Content.ReadAsStringAsync());
                return fr;
            } catch (Exception ex)
            {
                Console.WriteLine($"{ex.Message}");
            }
            return null;
        }

        public async Task WriteAsync(string collectionName, string id, string company, List<double> vector)
        {
            Customer customer = new Customer(id, company, vector);

            string customerJson = JsonConvert.SerializeObject(customer);


            var client = new HttpClient();
            var request = new HttpRequestMessage(HttpMethod.Post, "https://953ccde9-fa5a-4634-a3a9-31d41d3bfb33-us-east1.apps.astra.datastax.com/api/json/v1/default_keyspace/" + collectionName);
            request.Headers.Add("Token", "AstraCS:jBqdQovblyPQlWIgBZtsGEws:aa14ebbbcd7f99d3f419f9ae56439cacd776bbc0bf20892e654a42a72a187879");
            var content = new StringContent(customerJson, null, "application/json");
            request.Content = content;
            var response = await client.SendAsync(request);
            response.EnsureSuccessStatusCode();
            Console.WriteLine(await response.Content.ReadAsStringAsync());

        }

        public async Task WriteAsync(string collectionName, Customers customers)
        {

            string customersJson = JsonConvert.SerializeObject(customers);


            var client = new HttpClient();
            var request = new HttpRequestMessage(HttpMethod.Post, "https://953ccde9-fa5a-4634-a3a9-31d41d3bfb33-us-east1.apps.astra.datastax.com/api/json/v1/default_keyspace/" + collectionName);
            request.Headers.Add("Token", "AstraCS:jBqdQovblyPQlWIgBZtsGEws:aa14ebbbcd7f99d3f419f9ae56439cacd776bbc0bf20892e654a42a72a187879");
            var content = new StringContent(customersJson, null, "application/json");
            request.Content = content;
            var response = await client.SendAsync(request);
            response.EnsureSuccessStatusCode();
            Console.WriteLine(await response.Content.ReadAsStringAsync());

        }
    }

    // -- INSERT ONE

    public class Document
    {
        public string _id { get; set; }
        public string company { get; set; }

        [JsonProperty("$vector")]
        public List<double> vector { get; set; }
    }

    public class InsertOne
    {
        public Document document { get; set; } = new Document();
    }

    public class Customer
    {
        public InsertOne insertOne { get; set; } = new InsertOne();

        public Customer() { }

        public Customer(string id, string company, List<double> vector)
        {
            this.insertOne.document._id = id;
            this.insertOne.document.company = company;
            this.insertOne.document.vector = vector;
        }
    }

    // -- INSERT MANY

    public class InsertMany
    {
        public List<Document> documents { get; set; } = new List<Document>();
        public Options options { get; set; } = new Options();
    }

    public class Options
    {
        public bool ordered { get; set; } = false;
    }

    public class Customers
    {
        public InsertMany insertMany { get; set; } = new InsertMany();
    }

    // -- FIND REQUEST

    public class FindRequestBody
    {
        public Sort sort { get; set; } = new Sort();
        public FindOptions options { get; set; } = new FindOptions();
    }

    public class FindOptions
    {
        public int limit { get; set; } = 1;
        public bool includeSimilarity { get; set; } = true;
    }

    public class FindRequest
    {
        public FindRequestBody find { get; set; } = new FindRequestBody();
    }

    public class Sort
    {
        [JsonProperty("$vector")]
        public List<double> vector { get; set; } = new List<double>();
    }

    // -- FIND RESULT

    public class FoundData
    {
        public List<FoundDocument> documents { get; set; }
        public object nextPageState { get; set; }
    }

    public class FoundDocument
    {
        public string _id { get; set; }
        public string company { get; set; }

        [JsonProperty("$vector")]
        public List<double> vector { get; set; }

        [JsonProperty("$similarity")]
        public double similarity { get; set; }
    }

    public class FindResult
    {
        public FoundData data { get; set; }
    }

}
